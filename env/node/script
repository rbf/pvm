#!/bin/zsh

__DEVENV_SECONDARY_NAME="npm"
__DEVENV_PORT="3000"

__DEVENV_IMP_GET_STARTED_URL='https://nodejs.org/en/docs/guides/getting-started-guide/'

__DEVENV_IMP_HOW_TO_HELLO_WORLD_LINES+=("echo 'console.log(\"<<HELLOWORLDTEXT>>\")' > hello_world.js")
__DEVENV_IMP_HOW_TO_HELLO_WORLD_LINES+=("node hello_world.js")

function __devenv_imp_after_docker_dev_img_start() {
  if ! [ -f "${__DEVENV_HOST_USER_CONFIG_DIR_FULL_PATH}/.node/bin/npm" ]; then
    if [ -d "${__DEVENV_HOST_USER_CONFIG_DIR_FULL_PATH}/.node" ]; then
      __devenv_echo_error "'${__DEVENV_HOST_USER_CONFIG_DIR_FULL_PATH}/.node' directory is present but 'npm' executable is missing. Something went wrong. Exit and relaunch the env setup."
      return 1
    fi
    print "Copying preinstalled node dependencies and tools into '.node' dir..."
    __devenv_docker_dev_img_exec mkdir -p "${__DEVENV_CONTAINER_USER_CONFIG_DIR_FULL_PATH}"
    __devenv_docker_dev_img_exec cp -R /home/preinstalled-node-prefix/ "${__DEVENV_CONTAINER_USER_CONFIG_DIR_FULL_PATH}/.node"
    echo
  fi
}

__DEVENV_IMP_COMMANDS_TO_RUN_AT_THE_END+=('node --version')
__DEVENV_IMP_COMMANDS_TO_RUN_AT_THE_END+=('npm --version')
__DEVENV_IMP_COMMANDS_TO_RUN_AT_THE_END+=('npx nodemon --version')
__DEVENV_IMP_COMMANDS_TO_RUN_AT_THE_END+=('npx eslint --version')

__DEVENV_IMP_ALIASES[node]='node'
__DEVENV_IMP_ALIASES[npm]='npm'
__DEVENV_IMP_ALIASES[npx]='npx'
